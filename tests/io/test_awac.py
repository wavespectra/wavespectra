from pathlib import Path
from datetime import datetime

import numpy as np
from matplotlib import pyplot as plt
from numpy.testing import assert_allclose

from wavespectra import read_awac
from wavespectra.input.awac import (
    parse_awac_nmnea_wave_parameters,
    parse_awac_nmea,
    read_awac_strings,
)

AWAC_EXAMPLE_DATA = """
$PNORF,B1,043020,234101,3,0.02,0.01,48,0.0762,0.0898,0.1479,0.2516,0.3469,0.3753,0.3995,0.4218,0.4327,0.4195,0.4219,0.4277,0.3751,0.3772,0.3213,0.2881,0.1973,0.1583,0.1560,0.0968,0.0370,-0.0486,-0.0142,-0.0233,0.0005,0.0251,0.0542,0.0543,-0.0205,0.0079,-0.0293,0.0759,0.1088,0.1308,0.1418,0.0951,0.0528,0.0034,-0.0025,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*02
$PNORF,A2,043020,234101,3,0.02,0.01,48,-0.0140,-0.0291,0.0830,0.4330,0.6757,0.6892,0.6402,0.5814,0.5075,0.5003,0.4477,0.3459,0.3187,0.2219,0.3134,0.4087,0.4135,0.4015,0.1987,0.2105,0.2260,0.3236,0.2709,0.2886,0.1652,-0.0034,0.1233,0.0935,0.2155,0.0436,0.0835,-0.0234,0.0007,0.0441,-0.0323,-0.0245,-0.0757,-0.0711,-0.0662,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*2D
$PNORF,B2,043020,234101,3,0.02,0.01,48,0.0183,0.0252,-0.1417,-0.3156,-0.5967,-0.6769,-0.7021,-0.7078,-0.6747,-0.6461,-0.6052,-0.5222,-0.4042,-0.3553,-0.3525,-0.3504,-0.2020,-0.1396,-0.0829,-0.0385,0.0113,0.0554,-0.0370,0.0529,0.0876,0.1173,0.0929,0.0776,0.0652,0.0218,0.0353,0.1348,0.0932,0.0741,0.0321,0.0258,0.0040,-0.0348,-0.0337,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*22
$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,000000,00,30,14.6,1513.0,291.1,2.0,0.3,16.365,17.07,0,0*6E
$PNORC,050120,000000,1,0.14,0.06,-0.01,0.15,67.4,C,146,144,146,,,*19
$PNORC,050120,000000,2,0.18,0.12,-0.00,0.22,56.2,C,133,132,134,,,*14
$PNORC,050120,000000,3,0.20,0.06,-0.01,0.21,72.8,C,122,122,124,,,*15
$PNORC,050120,000000,4,0.19,0.05,-0.01,0.19,75.7,C,113,113,117,,,*18
$PNORC,050120,000000,5,0.20,0.08,-0.00,0.22,68.9,C,104,103,106,,,*12
$PNORC,050120,000000,6,0.12,0.15,-0.00,0.19,37.8,C,94,92,95,,,*25
$PNORC,050120,000000,7,0.15,0.04,0.01,0.15,73.8,C,87,87,87,,,*06
$PNORC,050120,000000,8,0.10,0.09,0.01,0.13,48.4,C,81,79,81,,,*02
$PNORC,050120,000000,9,0.16,0.12,0.00,0.20,52.7,C,74,73,78,,,*00
$PNORC,050120,000000,10,0.18,0.09,0.00,0.20,62.4,C,68,67,72,,,*3E
$PNORC,050120,000000,11,0.11,0.09,0.00,0.14,53.0,C,65,63,65,,,*38
$PNORC,050120,000000,12,0.09,0.04,0.01,0.10,65.7,C,61,59,61,,,*31
$PNORC,050120,000000,13,0.10,0.04,0.01,0.10,69.8,C,56,55,57,,,*36
$PNORC,050120,000000,14,0.10,0.00,0.02,0.10,87.1,C,63,56,57,,,*3A
$PNORC,050120,000000,15,0.01,-0.28,0.00,0.29,177.8,C,99,80,84,,,*23
$PNORC,050120,000000,16,-0.04,-0.51,0.01,0.51,184.0,C,105,105,111,,,*39
$PNORC,050120,000000,17,-0.05,-0.34,0.03,0.35,189.2,C,63,77,83,,,*0A
$PNORC,050120,000000,18,0.05,-0.09,0.02,0.10,149.2,C,33,39,45,,,*29
$PNORW,050120,000101,3,4,2.30,2.20,2.73,3.36,8.37,12.66,8.44,156.74,7.76,158.27,1.00,16.39,0,0,0.13,76.10,0000*4F
$PNORE,050120,000101,3,0.02,0.01,98,0.063,0.029,0.020,0.182,2.671,5.169,6.311,4.587,2.876,1.802,1.817,1.
442,1.163,0.878,0.653,0.575,0.549,0.409,0.306,0.195,0.184,0.167,0.159,0.119,0.105,0.085,0.072,0.052,0.053,0.045,0.034,0.025,0.022,0.018,0.018,0.018,0.014,0.011,0.008,0.008,0.008,0.007,0.006,0.006,0.005,0.005,0.005,0.005,0.005,0.004,0.003,0.003,0.002,0.003,0.002,0.002,0.002,0.001,0.002,0.002,0.002,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.000,0.000,0.000,0.000,0.000,0.000*75
$PNORB,050120,000101,3,4,0.02,0.20,2.23,9.83,12.66,156.49,7.76,158.11,0000*5B
$PNORB,050120,000101,3,4,0.21,0.49,0.48,3.71,4.76,164.83,40.02,166.15,0000*55
$PNORF,A1,050120,000101,3,0.02,0.01,48,-0.1370,-0.1413,-0.2548,-0.7437,-0.9243,-0.9156,-0.9092,-0.9027,-0.8771,-0.8651,-0.8662,-0.8520,-0.8440,-0.8249,-0.8166,-0.8455,-0.8518,-0.8404,-0.8077,-0.7297,-0.6421,-0.5878,-0.5803,-0.5477,-0.5559,-0.5445,-0.3028,-0.2844,-0.1277,-0.2942,-0.2004,-0.1690,-0.1242,-0.0984,-0.0428,-0.0352,-0.0103,-0.0138,0.0057,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*06
$PNORF,B1,050120,000101,3,0.02,0.01,48,0.2317,0.2715,0.2530,0.2815,0.3104,0.3728,0.3932,0.3831,0.3758,0.3861,0.3942,0.4068,0.3551,0.3375,0.2897,0.2033,0.1489,0.0765,0.1139,0.1978,0.2613,0.1794,0.2080,0.0510,0.0194,-0.0606,0.0258,0.1475,0.1210,0.0400,0.0183,-0.0247,0.0287,0.0026,-0.0161,-0.0041,0.0134,0.0183,0.0113,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*05
$PNORF,A2,050120,000101,3,0.02,0.01,48,0.0298,-0.0182,0.0292,0.5327,0.7465,0.6843,0.6601,0.6511,0.5770,0.5368,0.5383,0.5018,0.5014,0.4659,0.4671,0.5400,0.5509,0.5443,0.4952,0.3610,0.2616,0.2780,0.3188,0.2016,0.1471,0.2066,0.1387,0.0577,0.0479,0.0829,0.0135,0.0651,-0.0119,0.0106,-0.0576,-0.0748,-0.0762,-0.0359,-0.0048,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*2B
$PNORF,B2,050120,000101,3,0.02,0.01,48,-0.0619,-0.0377,-0.0514,-0.3674,-0.5502,-0.6668,-0.7015,-0.6633,-0.6189,-0.6227,-0.6373,-0.6422,-0.5306,-0.4705,-0.3596,-0.2469,-0.1640,-0.0557,-0.0666,-0.1313,-0.1363,-0.0540,-0.0295,0.0234,0.0481,0.0893,0.0843,-0.0011,0.0024,0.0494,0.1149,0.1554,0.0620,-0.0601,-0.0865,-0.0371,-0.0058,-0.0191,-0.0185,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*0C
$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,002000,00,30,14.7,1513.0,290.9,2.0,0.2,16.402,17.07,0,0*63
$PNORC,050120,002000,1,0.17,0.06,-0.01,0.18,69.2,C,154,152,154,,,*1A
$PNORC,050120,002000,2,0.12,0.05,-0.01,0.13,65.0,C,138,136,138,,,*18
$PNORC,050120,002000,3,0.13,0.05,0.00,0.14,69.7,C,127,126,128,,,*36
$PNORC,050120,002000,4,0.09,0.06,-0.00,0.11,55.6,C,118,117,119,,,*13
$PNORC,050120,002000,5,0.14,0.09,0.01,0.17,58.0,C,108,106,109,,,*30
$PNORC,050120,002000,6,0.12,0.04,-0.00,0.12,71.6,C,96,94,99,
,,*28
$PNORC,050120,002000,7,0.12,0.11,-0.01,0.16,48.7,C,88,85,91,,,*24
$PNORC,050120,002000,8,0.10,0.10,-0.01,0.14,44.4,C,81,80,82,,,*2B
$PNORC,050120,002000,9,0.13,0.07,0.00,0.15,62.1,C,75,74,76,,,*08
$PNORC,050120,002000,10,0.12,0.10,0.01,0.15,50.6,C,69,67,72,,,*3B
$PNORC,050120,002000,11,0.13,0.08,-0.01,0.15,60.4,C,64,63,66,,,*12
$PNORC,050120,002000,12,0.06,0.04,0.01,0.07,55.8,C,60,59,61,,,*37
$PNORC,050120,002000,13,0.10,0.03,-0.00,0.11,72.9,C,57,55,58,,,*1B
$PNORC,050120,002000,14,0.02,0.02,0.03,0.03,50.2,C,61,56,58,,,*3E
$PNORC,050120,002000,15,-0.00,-0.22,-0.00,0.23,181.3,C,102,79,89,,,*1A
$PNORC,050120,002000,16,-0.01,-0.39,0.01,0.39,181.6,C,109,105,120,,,*33
$PNORC,050120,002000,17,-0.00,-0.15,0.02,0.15,180.8,C,64,76,87,,,*0C
$PNORC,050120,002000,18,0.04,0.01,0.02,0.04,76.3,C,37,43,47,,,*3D
$PNORW,050120,002101,3,4,2.39,2.25,2.84,3.31,8.44,12.12,8.49,156.13,6.75,156.97,0.99,16.37,0,4,0.15,78.09,0000*49
$PNORE,050120,002101,3,0.02,0.01,98,0.124,0.038,0.030,0.252,2.154,5.881,6.809,6.499,3.060,2.448,1.290,0.907,0.986,0.861,1.041,0.699,0.540,0.306,0.229,0.211,0.166,0.153,0.147,0.128,0.098,0.058,0.052,0.053,0.052,0.039,0.036,0.036,0.031,0.021,0.018,0.015,0.015,0.012,0.012,0.009,0.008,0.007,0.007,0.008,0.006,0.004,0.005,0.005,0.005,0.004,0.004,0.004,0.004,0.003,0.003,0.003,0.003,0.003,0.003,0.004,0.003,0.003,0.002,0.002,0.002,0.002,0.003,0.003,0.003,0.002,0.002,0.002,0.002,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001*78
$PNORB,050120,002101,3,4,0.02,0.20,2.33,9.96,12.12,156.93,6.75,156.61,0000*53
$PNORB,050120,002101,3,4,0.21,0.49,0.47,3.67,4.76,176.06,36.29,172.28,0000*52
$PNORF,A1,050120,002101,3,0.02,0.01,48,-0.1114,-0.3294,-0.4048,-0.7349,-0.8758,-0.9242,-0.9093,-0.8919,-0.8498,-0.8315,-0.8171,-0.7907,-0.8052,-0.8336,-0.8587,-0.8564,-0.8118,-0.7732,-0.7535,-0.7975,-0.7799,-0.6977,-0.6564,-0.6053,-0.5500,-0.4040,-0.2659,-0.3339,-0.2107,-0.0286,-0.0066,0.0372,-0.0503,-0.0466,-0.0868,-0.0405,-0.0406,-0.0255,-0.0097,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*00
$PNORF,B1,050120,002101,3,0.02,0.01,48,0.1713,0.0725,0.1932,0.3574,0.3890,0.3624,0.3948,0.4174,0.4563,0.4649,0.4568,0.4257,0.3783,0.2795,0.2171,0.1325,0.1869,0.1272,0.0915,0.0550,0.0715,0.0485,0.0385,0.1316,0.2278,0.2623,0.1574,0.1387,-0.0256,-0.0569,-0.1524,-0.0436,0.0003,-0.0025,-0.0163,0.0058,-0.0009,-0.0132,-0.0052,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*23
$PNORF,A2,050120,002101,3,0.02,0.01,48,0.0834,0.1945,0.2014,0.5384,0.6312,0.7125,0.6600,0.6070,0.4885,0.4475,0.4125,0.3882,0.4415,0.5518,0.6191,0.5884,0.5026,0.4475,0.4384,0.4623,0.4364,0.2985,0.2786,0.2228,0.2970,0.1680,0.0876,0.1338,0.0412,-0.0404,-0.2574,-0.2796,-0.1782,-0.0881,-0.0037,-0.0024,-0.0153,-0.0247,-0.0404,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*02
$PNORF,B2,050120,002101,3,0.02,0.01,48,0.0209,-0.0207,-0.0873,-0.4611,-0.6308,-0.6600,-0.7053,-0.7203,-0.7265,-0.7111,-0.6722,-0.5745,-0.5012,-0.3571,-0.2730,-0.1301,-0.1738,-0.0465,0.0182,0.0109,-0.0312,-0.0006,0.0565,-0.0137,-0.0233,0.0034,0.1446,0.0959,0.1010,0.0351,0.0031,-0.0487,-0.0431,-0.0371,0.0419,0.0900,0.0722,0.0398,-0.0135,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*22

$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,004000,00,30,14.6,1512.9,290.8,2.0,0.2,16.391,17.06,0,0*61
$PNORC,050120,004000,1,0.10,0.02,-0.01,0.11,77.9,C,154,152,156,,,*10
$PNORC,050120,004000,2,0.14,0.04,0.00,0.15,72.4,C,139,138,139,,,*3F
$PNORC,050120,004000,3,0.14,-0.00,-0.01,0.14,92.1,C,130,129,130,,,*31
$PNORC,050120,004000,4,0.16,0.04,-0.03,0.17,75.3,C,121,122,124,,,*19
$PNORC,050120,004000,5,0.16,0.02,-0.03,0.16,83.2,C,111,111,114,,,*17
$PNORC,050120,004000,6,0.14,0.02,-0.02,0.14,81.2,C,97,97,100,,,*12
$PNORC,050120,004000,7,0.16,0.04,-0.02,0.16,76.8,C,88,88,88,,,*26
$PNORC,050120,004000,8,0.14,0.01,-0.02,0.14,86.7,C,79,78,81,,,*24
$PNORC,050120,004000,9,0.14,0.02,0.00,0.14,82.4,C,77,75,76,,,*05
$PNORC,050120,004000,10,0.15,0.01,0.00,0.15,86.2,C,73,70,71,,,*3A
$PNORC,050120,004000,11,0.12,0.02,-0.01,0.12,81.1,C,65,63,68,,,*1D
$PNORC,050120,004000,12,0.14,-0.05,-0.03,0.14,110.3,C,61,59,63,,,*0B
$PNORC,050120,004000,13,0.14,-0.08,-0.02,0.16,118.0,C,59,57,58,,,*02
$PNORC,050120,004000,14,0.12,-0.08,-0.02,0.14,123.2,C,65,58,58,,,*0B
$PNORC,050120,004000,15,0.20,-0.36,-0.02,0.41,151.3,C,110,84,94,,,*30
$PNORC,050120,004000,16,0.10,-0.67,-0.00,0.68,171.2,C,124,118,136,,,*34
$PNORC,050120,004000,17,0.05,-0.34,-0.02,0.35,171.8,C,63,81,86,,,*0E
$PNORC,050120,004000,18,0.00,-0.09,-0.01,0.09,176.9,C,33,39,42,,,*0E
$PNORW,050120,004101,3,4,2.41,2.38,3.05,3.94,8.51,12.15,8.96,157.41,8.02,158.11,1.00,16.29,0,0,0.15,87.02,0000*43
$PNORE,050120,004101,3,0.02,0.01,98,0.057,0.056,0.049,0.323,2.408,4.724,6.727,5.997,4.250,2.383,1.711,1.269,1.422,1.077,0.999,0.625,0.446,0.292,0.210,0.166,0.156,0.125,0.097,0.084,0.076,0.073,0.069,0.060,0.041,0.033,0.031,0.031,0.024,0.021,0.015,0.015,0.013,0.012,0.013,0.011,0.011,0.006,0.007,0.006,0.006,0.006,0.005,0.004,0.004,0.003,0.004,0.004,0.003,0.003,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001*7D
$PNORB,050120,004101,3,4,0.02,0.20,2.36,9.80,12.15,157.47,8.02,157.93,0000*5A
$PNORB,050120,004101,3,4,0.21,0.49,0.44,3.61,4.76,164.78,38.43,161.90,0000*58
$PNORF,A1,050120,004101,3,0.02,0.01,48,-0.2738,-0.4063,-0.4216,-0.7765,-0.8930,-0.9025,-0.9133,-0.9077,-0.8951,-0.8889,-0.8627,-0.8599,-0.8415,-0.8371,-0.8297,-0.8506,-0.8216,-0.8278,-0.7700,-0.7479,-0.6532,-0.5735,-0.4804,-0.5296,-0.3126,-0.2545,-0.1152,-0.0773,-0.1589,-0.2023,-0.1762,-0.1535,-0.1577,-0.0677,-0.0237,0.0082,0.0092,0.0180,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*0F
$PNORF,B1,050120,004101,3,0.02,0.01,48,0.3417,0.3433,0.2541,0.3186,0.3947,0.3833,0.3807,0.3750,0.3618,0.3360,0.3807,0.3621,0.3865,0.3372,0.2646,0.1534,0.2005,0.1419,0.1960,0.2035,0.2025,0.2047,0.2577,
0.2709,0.1807,0.0665,0.0769,-0.0061,-0.0463,-0.1965,-0.0863,-0.0125,0.0870,0.0985,0.0390,-0.0229,-0.0412,-0.0306,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*2B
$PNORF,A2,050120,004101,3,0.02,0.01,48,0.0350,0.0832,0.1676,0.5146,0.6265,0.6634,0.6808,0.6668,0.6292,0.6136,0.5358,0.5368,0.4666,0.4660,0.4700,0.5494,0.4883,0.5221,0.3987,0.3730,0.2325,0.1745,0.0367,0.0807,0.0658,-0.0287,-0.1314,-0.1839,-0.2127,-0.0257,0.0214,0.0813,-0.1091,-0.1167,-0.0604,0.0014,0.0317,0.0161,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*2C
$PNORF,B2,050120,004101,3,0.02,0.01,48,-0.1603,-0.2191,-0.1809,-0.4653,-0.6692,-0.6606,-0.6788,-0.6522,-0.6099,-0.5507,-0.5985,-0.5640,-0.5945,-0.4995,-0.3550,-0.2092,-0.2857,-0.1749,-0.1969,-0.1968,-0.1797,-0.1421,-0.0842,-0.0821,0.0820,0.1287,0.0492,-0.0119,0.0595,0.0978,-0.0103,-0.0044,-0.0471,-0.0652,-0.0562,-0.0287,-0.0216,0.0025,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*2B
$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,010000,00,30,14.6,1512.8,290.9,1.9,0.3,16.155,17.03,0,0*60
$PNORC,050120,010000,1,0.21,0.01,-0.01,0.21,86.4,C,158,156,159,,,*13
$PNORC,050120,010000,2,0.17,-0.03,-0.01,0.17,99.5,C,142,141,142,,,*37
$PNORC,050120,010000,3,0.17,0.03,-0.03,0.18,81.9,C,133,133,135,,,*10
$PNORC,050120,010000,4,0.21,0.03,0.00,0.21,83.0,C,126,125,128,,,*32
$PNORC,050120,010000,5,0.21,0.00,0.00,0.21,89.7,C,121,118,119,,,*36
$PNORC,050120,010000,6,0.20,0.00,-0.00,0.20,90.0,C,110,108,112,,,*1F
$PNORC,050120,010000,7,0.19,0.08,-0.03,0.21,67.9,C,101,99,101,,,*24
$PNORC,050120,010000,8,0.20,-0.06,-0.01,0.21,106.8,C,91,87,90,,,*39
$PNORC,050120,010000,9,0.23,-0.02,-0.03,0.23,95.7,C,80,76,80,,,*04
$PNORC,050120,010000,10,0.22,-0.08,0.00,0.23,108.7,C,73,70,74,,,*2D
$PNORC,050120,010000,11,0.23,-0.02,-0.01,0.23,95.8,C,66,66,69,,,*3E
$PNORC,050120,010000,12,0.19,-0.07,-0.01,0.20,109.2,C,62,60,66,,,*01
$PNORC,050120,010000,13,0.20,-0.09,-0.01,0.22,115.6,C,62,59,64,,,*07
$PNORC,050120,010000,14,0.21,-0.19,0.00,0.28,131.6,C,82,70,76,,,*26
$PNORC,050120,010000,15,0.23,-0.30,-0.02,0.38,141.8,C,87,85,92,,,*0C
$PNORC,050120,010000,16,0.14,-0.28,-0.02,0.32,152.8,C,79,76,86,,,*02
$PNORC,050120,010000,17,0.15,-0.26,-0.02,0.30,149.2,C,68,72,84,,,*08
$PNORC,050120,010000,18,0.14,-0.07,-0.02,0.16,114.6,C,42,51,59,,,*04
$PNORW,050120,010101,3,4,2.54,2.47,3.32,4.14,9.07,12.38,8.45,158.57,7.15,157.04,0.99,16.22,0,2,0.18,86.55,0000*4E
$PNORE,050120,010101,3,0.02,0.01,98,0.111,0.031,0.025,0.214,3.195,6.826,8.852,7.360,4.080,1.962,1.366,1.132,0.770,0.681,0.596,0.615,0.457,0.432,0.317,0.213,0.197,0.151,0.148,0.101,0.082,0.064,0.077,0.057,0.046,0.030,0.029,0.029,0.023,0.019,0.012,0.012,0.010,0.010,0.006,0.007,0.006,0.005,0.004,0.004,0.004,0.005,0.004,0.003,0.003,0.003,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.
001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.000,0.000,0.001,0.001,0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000*73
$PNORB,050120,010101,3,4,0.02,0.20,2.49,10.38,12.38,158.59,7.15,157.03,0000*63
$PNORB,050120,010101,3,4,0.21,0.49,0.47,3.77,4.76,164.56,40.43,165.61,0000*50
$PNORF,A1,050120,010101,3,0.02,0.01,48,-0.2921,-0.1390,-0.3030,-0.7237,-0.8889,-0.9164,-0.9233,-0.9171,-0.8700,-0.8395,-0.8102,-0.8015,-0.7893,-0.7689,-0.7592,-0.7590,-0.7736,-0.7802,-0.8033,-0.7239,-0.7057,-0.6570,-0.5669,-0.4359,-0.3399,-0.3182,-0.3432,-0.2203,-0.1545,-0.1129,-0.1634,-0.1126,-0.0269,0.0086,0.0380,0.0438,0.0507,0.0245,0.0008,-0.0007,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*21
$PNORF,B1,050120,010101,3,0.02,0.01,48,0.2503,0.1907,0.2245,0.3492,0.3815,0.3717,0.3635,0.3469,0.4097,0.4322,0.4792,0.4736,0.4009,0.3897,0.3906,0.3700,0.2763,0.2617,0.2303,0.1999,0.2000,0.1029,0.1634,0.1075,0.2336,0.1284,0.0772,-0.0061,-0.0196,-0.0311,-0.1052,-0.0664,0.0198,0.0470,0.0230,0.0063,-0.0071,0.0006,0.0012,0.0003,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*27
$PNORF,A2,050120,010101,3,0.02,0.01,48,0.1138,0.0214,0.0361,0.3730,0.6307,0.6903,0.7105,0.7156,0.5623,0.4886,0.4059,0.3799,0.4002,0.3479,0.3093,0.2693,0.3578,0.3848,0.4578,0.3169,0.3118,0.2304,0.1409,0.0810,0.0692,0.0693,0.0486,-0.0598,0.0105,0.0018,-0.0467,-0.1680,-0.0356,-0.0531,0.0037,-0.0363,-0.0176,-0.0292,-0.0174,-0.0317,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*27
$PNORF,B2,050120,010101,3,0.02,0.01,48,-0.0215,0.0014,-0.0979,-0.4104,-0.6312,-0.6647,-0.6601,-0.6092,-0.6659,-0.6623,-0.7058,-0.6797,-0.5044,-0.4809,-0.4782,-0.4898,-0.3348,-0.3092,-0.3004,-0.1658,-0.1446,-0.0314,-0.0932,-0.0577,-0.1382,-0.0327,-0.0386,0.1075,0.0980,-0.0241,-0.0637,-0.0563,-0.0381,0.0086,-0.0020,0.0080,-0.0134,-0.0281,-0.0170,-0.0330,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*0B
$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,012000,00,30,14.6,1512.8,290.9,2.0,0.2,16.193,17.03,0,0*63
$PNORC,050120,012000,1,0.13,-0.02,-0.01,0.13,98.8,C,163,161,165,,,*3F
$PNORC,050120,012000,2,0.19,0.04,-0.01,0.20,78.3,C,146,145,147,,,*19
$PNORC,050120,012000,3,0.09,0.01,0.01,0.09,81.9,C,138,136,137,,,*3C
$PNORC,050120,012000,4,0.16,0.04,0.00,0.17,75.3,C,130,128,130,,,*3F
$PNORC,050120,012000,5,0.13,0.05,0.00,0.14,67.3,C,123,121,124,,,*34
$PNORC,050120,012000,6,0.19,0.07,-0.01,0.21,69.5,C,114,115,115,,,*1C
$PNORC,050120,012000,7,0.18,0.04,-0.02,0.19,77.1,C,103,102,104,,,*1C
$PNORC,050120,012000,8,0.20,0.07,-0.00,0.21,71.1,C,87,87,89,,,*21
$PNORC,050120,012000,9,0.13,-0.02,-0.01,0.13,99.8,C,78,77,79,,,*07
$PNORC,050120,012000,10,0.15,0.02,-0.01,0.15,81.0,C,71,69,73,,,*1F
$PNORC,050120,012000,11,0.16,
-0.01,-0.01,0.16,92.9,C,66,64,68,,,*3A
$PNORC,050120,012000,12,0.17,-0.05,-0.01,0.18,106.6,C,61,60,63,,,*09
$PNORC,050120,012000,13,0.21,-0.10,-0.01,0.23,117.0,C,58,57,59,,,*00
$PNORC,050120,012000,14,0.13,-0.13,-0.00,0.19,135.0,C,71,60,64,,,*0C
$PNORC,050120,012000,15,0.09,-0.37,0.00,0.38,165.7,C,98,83,89,,,*25
$PNORC,050120,012000,16,0.03,-0.47,0.01,0.47,176.2,C,95,90,102,,,*18
$PNORC,050120,012000,17,0.05,-0.23,0.01,0.24,167.3,C,61,69,77,,,*27
$PNORC,050120,012000,18,0.08,-0.02,0.00,0.08,107.0,C,34,41,43,,,*21
$PNORW,050120,012101,3,4,2.22,2.13,2.61,3.41,8.69,12.51,9.04,156.96,9.54,155.64,0.99,16.14,0,0,0.18,91.39,0000*49
$PNORE,050120,012101,3,0.02,0.01,98,0.069,0.046,0.035,0.187,1.811,5.653,6.464,5.635,2.305,1.718,1.323,0.901,0.780,0.793,0.707,0.493,0.246,0.211,0.207,0.150,0.118,0.123,0.116,0.109,0.081,0.061,0.053,0.045,0.039,0.034,0.034,0.030,0.024,0.023,0.019,0.018,0.015,0.010,0.010,0.008,0.009,0.008,0.008,0.007,0.006,0.004,0.003,0.003,0.003,0.003,0.003,0.002,0.002,0.002,0.002,0.001,0.002,0.002,0.002,0.001,0.002,0.001,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.000,0.000,0.000*72
$PNORB,050120,012101,3,4,0.02,0.20,2.17,10.22,12.51,156.96,9.54,155.82,0000*63
$PNORB,050120,012101,3,4,0.21,0.49,0.43,3.60,4.76,157.95,47.45,154.52,0000*5C
$PNORF,A1,050120,012101,3,0.02,0.01,48,-0.3446,-0.1800,-0.1614,-0.6210,-0.8407,-0.8961,-0.9075,-0.8959,-0.8781,-0.8650,-0.8616,-0.8008,-0.7882,-0.7840,-0.7925,-0.7864,-0.7446,-0.7231,-0.6760,-0.6090,-0.5661,-0.6013,-0.5335,-0.5295,-0.3603,-0.3098,-0.1407,-0.1461,-0.1302,-0.0329,0.0004,0.0388,0.0930,0.0624,0.0329,0.0177,0.0078,-0.0015,-0.0023,0.0031,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*2B
$PNORF,B1,050120,012101,3,0.02,0.01,48,0.2953,0.3436,0.3490,0.3625,0.4092,0.4121,0.3858,0.3963,0.3958,0.3773,0.3327,0.4172,0.4243,0.4037,0.4051,0.3368,0.2563,0.1369,0.1709,0.2466,0.2314,0.2551,0.2283,0.2554,0.2219,0.1942,0.1381,0.1538,0.0028,-0.0500,-0.0024,-0.0039,0.0274,0.0881,0.0703,0.0518,-0.0042,0.0040,0.0093,0.0063,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*25
$PNORF,A2,050120,012101,3,0.02,0.01,48,-0.0327,-0.0213,-0.0300,0.3354,0.5415,0.6194,0.6575,0.6250,0.5746,0.5402,0.5451,0.3883,0.3866,0.3894,0.3958,0.3997,0.3287,0.3370,0.2583,0.1708,0.1566,0.1797,0.1937,0.1122,0.0761,0.0469,0.0043,-0.0139,-0.0410,-0.0712,0.0603,0.1069,0.1032,-0.0176,-0.0263,-0.0307,0.0040,-0.0070,-0.0183,-0.0387,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*20
$PNORF,B2,050120,012101,3,0.02,0.01,48,-0.1651,-0.0398,-0.0190,-0.3088,-0.6008,-0.7174,-0.6808,-0.6793,-0.6563,-0.6008,-0.5165,-0.5710,-0.5493,-0.5124,-0.5262,-0.4165,-0.3291,-0.1587,-0.1213,-0.1289,-0.0251,-0.1149,-0.1161,-0.1953,-0.1311,-0.0398,0.0429,0.0307,0.0752,-0.0165,0.0916,0.1506,0.1698,0.0333,0.0182,0.0116,-0.0034,-0.0030,-0.0192,-0.0337,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*06

$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,014000,00,30,14.6,1512.8,290.9,2.0,0.2,16.105,17.02,0,0*6B
$PNORC,050120,014000,1,0.13,-0.02,-0.02,0.13,97.7,C,162,160,162,,,*3D
$PNORC,050120,014000,2,0.14,-0.00,-0.03,0.14,90.4,C,144,142,144,,,*39
$PNORC,050120,014000,3,0.16,0.04,-0.03,0.16,77.5,C,135,133,136,,,*1C
$PNORC,050120,014000,4,0.15,0.01,-0.03,0.15,87.3,C,128,126,125,,,*1D
$PNORC,050120,014000,5,0.16,-0.01,-0.02,0.16,94.6,C,118,116,114,,,*35
$PNORC,050120,014000,6,0.21,-0.03,-0.00,0.21,97.4,C,106,104,104,,,*3A
$PNORC,050120,014000,7,0.18,0.01,-0.02,0.18,85.6,C,94,91,94,,,*28
$PNORC,050120,014000,8,0.18,-0.03,-0.02,0.19,99.3,C,84,83,84,,,*02
$PNORC,050120,014000,9,0.22,-0.05,-0.02,0.22,103.7,C,77,75,76,,,*3A
$PNORC,050120,014000,10,0.15,-0.06,-0.02,0.16,113.4,C,69,70,71,,,*0D
$PNORC,050120,014000,11,0.15,-0.09,0.00,0.17,120.2,C,65,64,65,,,*27
$PNORC,050120,014000,12,0.14,-0.07,-0.01,0.16,117.4,C,62,61,63,,,*00
$PNORC,050120,014000,13,0.14,-0.04,-0.02,0.15,106.6,C,61,58,61,,,*0B
$PNORC,050120,014000,14,0.14,-0.17,-0.02,0.22,140.7,C,79,67,69,,,*04
$PNORC,050120,014000,15,0.10,-0.38,-0.00,0.40,166.0,C,116,98,109,,,*06
$PNORC,050120,014000,16,0.08,-0.50,0.00,0.50,170.4,C,106,112,122,,,*16
$PNORC,050120,014000,17,0.11,-0.20,0.00,0.23,150.3,C,61,76,80,,,*23
$PNORC,050120,014000,18,0.11,-0.05,-0.01,0.12,116.4,C,33,39,42,,,*02
$PNORW,050120,014101,3,4,2.43,2.35,3.00,3.56,8.93,12.65,8.49,156.58,8.28,155.95,0.99,16.03,0,0,0.17,95.04,0000*43
$PNORE,050120,014101,3,0.02,0.01,98,0.095,0.056,0.024,0.446,2.858,6.828,7.906,6.324,3.003,1.576,1.210,1.032,1.055,0.977,0.706,0.557,0.431,0.340,0.163,0.186,0.172,0.153,0.112,0.085,0.077,0.054,0.038,0.040,0.035,0.036,0.030,0.027,0.021,0.018,0.015,0.014,0.010,0.009,0.008,0.007,0.006,0.006,0.006,0.005,0.004,0.004,0.004,0.004,0.004,0.003,0.004,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.003,0.002,0.002,0.001,0.001,0.002,0.002,0.002,0.002,0.001,0.002,0.002,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.000,0.000,0.000*7B
$PNORB,050120,014101,3,4,0.02,0.20,2.38,10.30,12.65,156.37,8.28,155.87,0000*68
$PNORB,050120,014101,3,4,0.21,0.49,0.43,3.72,4.76,161.00,44.06,162.74,0000*55
$PNORF,A1,050120,014101,3,0.02,0.01,48,-0.1863,-0.3075,-0.2082,-0.8120,-0.8925,-0.9183,-0.9076,-0.8665,-0.8538,-0.8370,-0.8415,-0.8413,-0.8425,-0.8123,-0.8159,-0.7804,-0.7883,-0.7633,-0.6777,-0.6659,-0.6435,-0.6543,-0.6555,-0.5661,-0.5010,-0.2872,-0.1593,-0.1509,-0.1931,-0.1876,-0.1190,-0.0158,0.0130,-0.0084,0.0169,0.0133,0.0356,0.0164,0.0118,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*2A
$PNORF,B1,050120,014101,3,0.02,0.01,48,0.3413,0.2683,0.0992,0.3418,0.3788,0.3782,0.3951,0.4220,0.4489,0.4523,0.4313,0.3792,0.3329,0.3491,0.3108,0.3054,0.2736,0.2785,0.3261,0.2293,0.2169,0.1342,0.1185,0.1
945,0.2172,0.2433,0.2564,0.1412,-0.0291,-0.1042,-0.0048,0.0672,-0.0215,-0.1327,-0.0632,-0.0431,-0.0336,-0.0349,-0.0082,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*0B
$PNORF,A2,050120,014101,3,0.02,0.01,48,-0.2114,-0.0301,0.1012,0.5993,0.6440,0.6909,0.6561,0.5512,0.4911,0.4490,0.4651,0.4945,0.4976,0.4214,0.4261,0.3659,0.4238,0.3649,0.2475,0.2924,0.3007,0.3329,0.2516,0.1875,0.1256,0.0112,-0.0756,-0.0089,-0.0769,-0.0668,-0.0843,-0.0906,-0.0551,-0.1095,-0.0188,-0.0020,0.0101,-0.0158,-0.0409,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*0E
$PNORF,B2,050120,014101,3,0.02,0.01,48,-0.2053,-0.1831,-0.0875,-0.5429,-0.6321,-0.6848,-0.7018,-0.6860,-0.7250,-0.7068,-0.6757,-0.5674,-0.4910,-0.4754,-0.4122,-0.3541,-0.2819,-0.2842,-0.2849,-0.1660,-0.1988,-0.0977,-0.1390,-0.1236,-0.1209,-0.0375,-0.0725,-0.0365,0.0133,0.1329,0.0606,0.1665,0.1455,0.0072,0.0094,0.0134,-0.0054,-0.0313,-0.0472,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*29
$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,020000,00,30,14.6,1512.8,290.9,2.0,0.3,16.026,17.01,0,0*6E
$PNORC,050120,020000,1,0.08,0.02,-0.02,0.09,74.1,C,158,155,159,,,*1A
$PNORC,050120,020000,2,0.09,0.05,-0.01,0.10,60.3,C,141,141,142,,,*14
$PNORC,050120,020000,3,0.11,-0.01,-0.02,0.11,97.4,C,131,131,132,,,*3F
$PNORC,050120,020000,4,0.17,0.02,-0.02,0.17,84.5,C,124,122,124,,,*14
$PNORC,050120,020000,5,0.11,0.01,-0.00,0.11,87.0,C,115,114,116,,,*14
$PNORC,050120,020000,6,0.13,0.05,-0.02,0.14,66.6,C,108,106,107,,,*10
$PNORC,050120,020000,7,0.13,0.01,-0.01,0.13,85.6,C,100,98,95,,,*18
$PNORC,050120,020000,8,0.15,0.07,-0.02,0.16,65.2,C,90,88,88,,,*2E
$PNORC,050120,020000,9,0.14,0.02,-0.01,0.15,81.0,C,80,78,81,,,*24
$PNORC,050120,020000,10,0.16,0.05,-0.01,0.17,74.2,C,75,72,73,,,*1E
$PNORC,050120,020000,11,0.16,-0.04,-0.02,0.16,103.9,C,69,65,70,,,*03
$PNORC,050120,020000,12,0.14,-0.06,-0.01,0.15,114.5,C,63,60,65,,,*01
$PNORC,050120,020000,13,0.15,-0.05,-0.01,0.16,109.4,C,59,57,59,,,*0E
$PNORC,050120,020000,14,0.16,-0.16,-0.01,0.22,136.3,C,73,62,66,,,*06
$PNORC,050120,020000,15,0.14,-0.48,-0.02,0.50,163.6,C,123,101,114,,,*39
$PNORC,050120,020000,16,0.09,-0.47,-0.01,0.48,169.8,C,101,117,128,,,*3F
$PNORC,050120,020000,17,0.13,-0.18,-0.05,0.22,143.8,C,48,65,70,,,*0B
$PNORC,050120,020000,18,0.13,-0.06,-0.04,0.14,114.3,C,31,34,38,,,*00
$PNORW,050120,020101,3,4,2.27,2.24,2.78,3.34,7.77,12.89,8.39,158.32,9.29,156.19,0.99,15.95,0,38,0.18,90.45,0000*71
$PNORE,050120,020101,3,0.02,0.01,98,0.070,0.043,0.027,0.704,3.464,5.549,6.202,4.310,2.448,1.872,1.438,1.208,0.845,0.821,0.522,0.411,0.258,0.234,0.178,0.167,0.146,0.140,0.125,0.121,0.089,0.069,0.056,0.043,0.037,0.028,0.023,0.020,0.020,0.022,0.021,0.018,0.016,0.017,0.012,0.010,0.008,0.009,0.008,0.007,0.008,0.009,0.007,0.005,0.005,0.009,0.009,0.010,0.009,0.011,0.010,0.008,0.007,0.008,0.009,0.008,0.008,0.007,0.009,0.
008,0.007,0.006,0.007,0.008,0.007,0.007,0.007,0.007,0.006,0.005,0.006,0.006,0.005,0.004,0.004,0.005,0.004,0.003,0.003,0.004,0.004,0.004,0.004,0.004,0.005,0.004,0.004,0.003,0.002,0.002,0.002,0.003,0.003,0.003*74
$PNORB,050120,020101,3,4,0.02,0.20,2.21,10.40,12.89,158.31,9.29,156.13,0000*64
$PNORB,050120,020101,3,4,0.21,0.49,0.45,3.61,4.76,165.62,45.71,161.12,0000*54
$PNORF,A1,050120,020101,3,0.02,0.01,48,-0.3155,-0.3961,-0.3579,-0.8613,-0.9053,-0.9184,-0.9173,-0.8672,-0.8616,-0.8373,-0.8273,-0.8110,-0.7912,-0.7941,-0.7911,-0.7586,-0.7422,-0.7804,-0.7347,-0.6604,-0.6249,-0.5955,-0.6181,-0.5854,-0.4661,-0.3399,-0.2560,-0.1766,-0.2148,-0.1251,-0.1055,0.0290,0.0924,0.0574,0.0377,-0.0172,0.0001,-0.0376,-0.0038,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*0C
$PNORF,B1,050120,020101,3,0.02,0.01,48,0.2466,0.2520,0.2466,0.3568,0.3795,0.3722,0.3623,0.4248,0.4176,0.4516,0.4592,0.4726,0.4256,0.3567,0.2559,0.2347,0.2265,0.2451,0.1915,0.1693,0.2170,0.2672,0.2296,0.1668,0.0869,0.1054,0.1369,0.1970,0.1992,0.0084,0.0250,-0.0085,-0.0326,-0.1149,-0.0567,-0.0133,0.0162,-0.0045,0.0201,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*06
$PNORF,A2,050120,020101,3,0.02,0.01,48,0.0750,0.1125,0.0625,0.6132,0.6559,0.6933,0.6933,0.5394,0.5229,0.4531,0.4371,0.3989,0.4080,0.4390,0.4848,0.4083,0.3683,0.4183,0.3915,0.3080,0.2242,0.1393,0.1141,0.2210,0.2407,0.2484,0.1338,0.0105,0.0757,0.0865,0.0403,-0.0028,-0.0192,0.0163,-0.0344,-0.0445,-0.0326,-0.0303,-0.0147,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*22
$PNORF,B2,050120,020101,3,0.02,0.01,48,-0.1185,-0.1121,-0.1098,-0.5566,-0.6605,-0.6708,-0.6453,-0.6952,-0.6727,-0.7020,-0.6967,-0.7007,-0.5635,-0.4415,-0.2649,-0.2198,-0.1882,-0.2556,-0.1988,-0.2546,-0.2584,-0.2600,-0.1721,-0.1420,-0.0535,-0.0735,-0.0763,0.0024,-0.0470,0.0158,-0.0025,0.0267,0.0133,0.0154,0.0197,-0.0061,-0.0398,-0.0619,-0.0673,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*2E
$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,022000,00,30,14.6,1512.7,291.2,1.9,0.2,15.863,16.99,0,0*68
$PNORC,050120,022000,1,0.05,-0.01,-0.01,0.05,106.9,C,159,155,159,,,*09
$PNORC,050120,022000,2,0.11,-0.01,-0.01,0.11,93.1,C,141,139,141,,,*35
$PNORC,050120,022000,3,0.01,0.01,0.01,0.02,57.3,C,131,129,134,,,*39
$PNORC,050120,022000,4,0.07,-0.03,0.00,0.08,113.6,C,124,123,128,,,*2B
$PNORC,050120,022000,5,0.10,-0.01,-0.03,0.11,96.5,C,117,117,123,,,*3B
$PNORC,050120,022000,6,0.06,0.04,-0.00,0.07,60.0,C,109,107,112,,,*13
$PNORC,050120,022000,7,0.09,0.03,-0.01,0.10,73.6,C,98,95,100,,,*19
$PNORC,050120,022000,8,0.12,0.06,0.01,0.14,62.0,C,89,85,89,,,*07
$PNORC,050120,022000,9,0.09,-0.02,-0.00,0.09,99.9,C,79,79,81,,,*0C
$PNORC,050120,022000,10,0.09,0.01,0.01,0.09,85.6,C,73,72,74,,,*3F
$PNORC,050120,022000,11,0.1
1,-0.03,0.00,0.11,105.7,C,72,67,72,,,*2B
$PNORC,050120,022000,12,0.14,-0.09,0.00,0.16,123.8,C,81,67,75,,,*20
$PNORC,050120,022000,13,0.17,-0.05,0.01,0.17,107.4,C,97,83,90,,,*22
$PNORC,050120,022000,14,0.26,-0.08,0.00,0.27,107.4,C,125,110,117,,,*15
$PNORC,050120,022000,15,0.44,-0.15,0.02,0.47,109.2,C,146,140,141,,,*13
$PNORC,050120,022000,16,0.38,-0.12,0.00,0.40,107.2,C,125,139,136,,,*1C
$PNORC,050120,022000,17,0.11,-0.03,0.01,0.11,103.0,C,80,100,97,,,*1B
$PNORC,050120,022000,18,0.05,-0.01,-0.01,0.05,98.5,C,48,65,61,,,*32
$PNORW,050120,022101,3,4,2.05,1.92,2.28,3.15,7.78,12.94,7.80,157.07,11.85,156.54,1.00,15.83,0,4,0.14,87.60,0000*7E
$PNORE,050120,022101,3,0.02,0.01,98,0.056,0.028,0.021,0.362,2.175,4.402,4.730,3.611,2.110,1.751,1.516,0.940,0.778,0.678,0.647,0.472,0.316,0.244,0.184,0.177,0.134,0.118,0.092,0.062,0.057,0.037,0.037,0.031,0.027,0.024,0.024,0.022,0.014,0.010,0.007,0.008,0.009,0.010,0.009,0.009,0.009,0.008,0.010,0.011,0.013,0.014,0.014,0.017,0.018,0.020,0.019,0.017,0.013,0.010,0.010,0.009,0.008,0.007,0.008,0.009,0.007,0.006,0.005,0.004,0.005,0.004,0.005,0.004,0.003,0.003,0.004,0.003,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.000*7C
$PNORB,050120,022101,3,4,0.02,0.20,1.99,9.97,12.94,157.00,11.85,156.55,0000*68
$PNORB,050120,022101,3,4,0.21,0.49,0.40,3.57,4.76,156.92,39.79,159.80,0000*5A
$PNORF,A1,050120,022101,3,0.02,0.01,48,-0.1247,-0.1287,-0.1722,-0.8472,-0.8990,-0.9075,-0.9023,-0.8969,-0.8802,-0.8670,-0.8606,-0.8356,-0.8230,-0.8272,-0.8066,-0.7978,-0.7462,-0.7310,-0.7098,-0.6981,-0.6395,-0.6033,-0.5109,-0.3854,-0.3584,-0.2964,-0.3754,-0.3237,-0.2187,-0.2858,-0.2464,-0.2599,-0.1407,-0.0896,0.0446,0.0540,0.0492,0.0154,0.0077,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*09
$PNORF,B1,050120,022101,3,0.02,0.01,48,0.2133,0.2237,0.2771,0.2591,0.4021,0.3936,0.3781,0.3723,0.3625,0.3797,0.3876,0.4153,0.4317,0.3890,0.3472,0.3274,0.3741,0.3924,0.3489,0.2976,0.2491,0.2390,0.2864,0.1546,0.1149,0.0281,0.0758,-0.0154,-0.0242,-0.0470,-0.0642,0.0151,0.0096,0.0688,0.0692,0.0644,0.0147,-0.0083,-0.0054,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*00
$PNORF,A2,050120,022101,3,0.02,0.01,48,-0.0681,-0.0787,-0.0261,0.6292,0.6290,0.6548,0.6495,0.6378,0.6040,0.5559,0.5348,0.4611,0.4213,0.4553,0.4367,0.4449,0.3310,0.2968,0.2650,0.2595,0.2144,0.1383,-0.0027,-0.0542,-0.0468,-0.0828,-0.0873,-0.0612,-0.1451,0.0286,0.0510,0.0808,0.0283,0.0343,0.0220,-0.0562,-0.0313,-0.0382,-0.0394,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*01
$PNORF,B2,050120,022101,3,0.02,0.01,48,-0.1013,-0.1207,-0.1341,-0.4462,-0.7008,-0.6989,-0.6500,-0.6247,-0.5822,-0.5997,-0.6044,-0.6223,-0.6403,-0.5655,-0.4472,-0.3856,-0.3993,-0.4265,-0.3399,-0.2627,-0.1577,-0.0230,-0.0460,0.0616,0.0130,0.0292,0.0288,0.0831,0.0847,0.0659,0.1698,0.0472,0.0282,-0.0197,0.0359,0.0247,0.0256,0.0081,-0.0134,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*28

$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,024000,00,30,14.6,1512.8,290.9,2.0,0.2,15.818,17.00,0,0*6C
$PNORC,050120,024000,1,0.16,0.00,-0.02,0.16,89.6,C,155,152,156,,,*1D
$PNORC,050120,024000,2,0.09,0.03,-0.01,0.10,70.6,C,139,137,140,,,*1E
$PNORC,050120,024000,3,0.14,0.07,-0.02,0.16,62.8,C,129,129,131,,,*17
$PNORC,050120,024000,4,0.07,0.05,-0.02,0.09,57.4,C,121,120,124,,,*11
$PNORC,050120,024000,5,0.14,0.02,-0.01,0.14,83.2,C,113,109,116,,,*1E
$PNORC,050120,024000,6,0.13,0.09,-0.01,0.16,55.5,C,102,100,104,,,*15
$PNORC,050120,024000,7,0.14,0.07,-0.02,0.16,63.8,C,92,91,96,,,*2D
$PNORC,050120,024000,8,0.13,0.06,-0.02,0.14,64.7,C,87,84,88,,,*21
$PNORC,050120,024000,9,0.14,0.01,-0.01,0.15,85.7,C,80,78,81,,,*20
$PNORC,050120,024000,10,0.15,0.02,-0.02,0.15,81.9,C,75,73,76,,,*1A
$PNORC,050120,024000,11,0.16,0.00,-0.01,0.16,89.3,C,70,66,71,,,*1E
$PNORC,050120,024000,12,0.19,-0.02,-0.01,0.20,96.4,C,66,64,67,,,*33
$PNORC,050120,024000,13,0.18,0.00,-0.01,0.18,89.4,C,71,60,64,,,*18
$PNORC,050120,024000,14,0.33,0.02,-0.04,0.33,86.1,C,105,79,82,,,*20
$PNORC,050120,024000,15,0.43,0.04,0.00,0.43,84.6,C,144,132,133,,,*0B
$PNORC,050120,024000,16,0.48,0.14,0.00,0.50,73.7,C,110,125,124,,,*08
$PNORC,050120,024000,17,0.24,0.02,-0.02,0.24,84.9,C,54,63,64,,,*19
$PNORC,050120,024000,18,0.22,0.06,-0.02,0.23,74.1,C,30,32,35,,,*16
$PNORW,050120,024101,3,4,2.32,2.25,2.81,3.51,8.28,12.58,8.50,154.16,8.84,154.18,1.00,15.73,0,4,0.13,87.98,0000*47
$PNORE,050120,024101,3,0.02,0.01,98,0.042,0.030,0.033,0.221,2.848,5.296,6.597,5.019,3.174,2.106,1.496,1.095,0.974,0.923,0.947,0.625,0.478,0.355,0.214,0.141,0.104,0.065,0.069,0.071,0.065,0.050,0.044,0.035,0.028,0.026,0.024,0.026,0.023,0.020,0.015,0.012,0.009,0.009,0.008,0.007,0.009,0.009,0.012,0.014,0.012,0.013,0.012,0.012,0.013,0.011,0.012,0.010,0.010,0.010,0.007,0.007,0.005,0.005,0.004,0.004,0.004,0.004,0.005,0.005,0.005,0.004,0.003,0.003,0.004,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.001,0.001,0.002,0.002,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001*75
$PNORB,050120,024101,3,4,0.02,0.20,2.27,9.93,12.58,153.92,8.84,154.16,0000*5F
$PNORB,050120,024101,3,4,0.21,0.49,0.39,3.45,4.76,163.62,41.81,161.72,0000*56
$PNORF,A1,050120,024101,3,0.02,0.01,48,0.0044,-0.1141,-0.3697,-0.7055,-0.9012,-0.9077,-0.8884,-0.8726,-0.8579,-0.8449,-0.8424,-0.8085,-0.8170,-0.8063,-0.7989,-0.7686,-0.8116,-0.7933,-0.7750,-0.7040,-0.6000,-0.3973,-0.4236,-0.4995,-0.4998,-0.4988,-0.3929,-0.3142,-0.2210,-0.1521,-0.0787,-0.0588,-0.0849,-0.0793,-0.1216,-0.0603,-0.0270,0.0030,0.0057,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*0C
$PNORF,B1,050120,024101,3,0.02,0.01,48,0.3530,0.1662,0.2506,0.3574,0.3796,0.3932,0.4325,0.4413,0.4381,0.4391,0.4343,0.4603,0.4297,0.4094,0.4392,0.4354,0.3647,0.3276,0.2451,0.2069,0.1829,0.3020,0.2801,
0.2004,0.0781,0.0182,0.0718,-0.0119,-0.0186,0.1048,0.1000,0.1200,0.0734,0.0168,-0.0120,-0.0781,-0.0396,-0.0327,-0.0054,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*28
$PNORF,A2,050120,024101,3,0.02,0.01,48,-0.0675,-0.0134,0.0696,0.3614,0.6543,0.6553,0.5883,0.5441,0.4999,0.4694,0.4698,0.4064,0.4277,0.4243,0.3662,0.2958,0.3946,0.3935,0.3996,0.3278,0.2489,0.0494,0.0225,0.0296,0.0892,0.1123,0.1042,0.0894,0.0481,0.0962,0.1294,0.0539,0.0198,-0.0474,0.0012,-0.0097,0.0191,-0.0280,-0.0400,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*08
$PNORF,B2,050120,024101,3,0.02,0.01,48,0.0339,0.0099,-0.1183,-0.4503,-0.6528,-0.6984,-0.7506,-0.7381,-0.7131,-0.6923,-0.6792,-0.6698,-0.6286,-0.5764,-0.6205,-0.5656,-0.4887,-0.3723,-0.2270,-0.1383,-0.1351,-0.1170,-0.0225,-0.0342,0.1044,0.0746,0.0049,0.0103,0.0300,-0.0018,-0.0404,-0.0610,0.0333,-0.0282,-0.0035,-0.0874,-0.0151,-0.0072,-0.0010,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*2D
$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,030000,00,30,14.6,1512.8,290.9,2.0,0.2,15.710,17.00,0,0*6E
$PNORC,050120,030000,1,0.07,-0.05,-0.02,0.08,122.7,C,152,151,153,,,*0F
$PNORC,050120,030000,2,0.05,-0.04,-0.02,0.06,124.7,C,138,136,139,,,*06
$PNORC,050120,030000,3,0.02,-0.02,0.00,0.03,132.3,C,132,128,131,,,*22
$PNORC,050120,030000,4,0.08,-0.07,-0.01,0.11,133.8,C,127,122,125,,,*04
$PNORC,050120,030000,5,0.10,0.00,-0.01,0.10,90.0,C,118,114,118,,,*10
$PNORC,050120,030000,6,0.05,-0.05,-0.03,0.07,139.0,C,108,107,109,,,*0A
$PNORC,050120,030000,7,0.07,-0.02,-0.02,0.08,108.4,C,100,96,99,,,*0F
$PNORC,050120,030000,8,0.13,-0.05,-0.02,0.14,113.6,C,90,86,91,,,*36
$PNORC,050120,030000,9,0.14,-0.03,-0.01,0.15,101.3,C,83,81,83,,,*34
$PNORC,050120,030000,10,0.12,-0.04,-0.02,0.13,106.9,C,78,75,78,,,*0E
$PNORC,050120,030000,11,0.09,-0.11,-0.01,0.14,142.7,C,71,70,74,,,*0B
$PNORC,050120,030000,12,0.15,-0.09,-0.01,0.17,120.0,C,68,64,68,,,*0C
$PNORC,050120,030000,13,0.18,-0.07,0.01,0.19,111.1,C,67,65,66,,,*2E
$PNORC,050120,030000,14,0.18,-0.02,-0.02,0.18,96.1,C,97,81,83,,,*33
$PNORC,050120,030000,15,0.28,0.29,0.01,0.40,43.5,C,127,124,123,,,*05
$PNORC,050120,030000,16,0.31,0.25,-0.03,0.40,50.7,C,84,103,105,,,*14
$PNORC,050120,030000,17,0.14,0.07,-0.03,0.16,64.2,C,45,54,60,,,*1F
$PNORC,050120,030000,18,0.17,0.06,-0.02,0.18,69.7,C,33,34,39,,,*1E
$PNORW,050120,030101,3,4,2.42,2.35,2.99,3.73,8.74,12.63,8.92,156.74,7.77,155.38,1.00,15.69,0,0,0.14,92.81,0000*40
$PNORE,050120,030101,3,0.02,0.01,98,0.064,0.043,0.032,0.159,3.485,6.276,7.737,5.703,3.666,2.194,1.554,0.865,0.871,0.870,0.739,0.546,0.335,0.268,0.228,0.145,0.129,0.113,0.085,0.052,0.038,0.031,0.041,0.038,0.035,0.019,0.016,0.012,0.017,0.015,0.014,0.011,0.013,0.012,0.010,0.007,0.009,0.010,0.012,0.011,0.011,0.011,0.011,0.009,0.010,0.008,0.011,0.009,0.010,0.008,0.007,0.006,0.006,0.006,0.005,0.004,0.005,0.005,0.004,0.
003,0.003,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001*7C
$PNORB,050120,030101,3,4,0.02,0.20,2.38,10.33,12.63,156.74,7.77,155.48,0000*6A
$PNORB,050120,030101,3,4,0.21,0.49,0.39,3.52,4.76,160.91,43.45,158.02,0000*5D
$PNORF,A1,050120,030101,3,0.02,0.01,48,-0.2897,-0.4074,-0.4660,-0.6342,-0.8725,-0.9035,-0.9109,-0.8987,-0.8806,-0.8678,-0.8726,-0.8467,-0.8315,-0.7992,-0.7890,-0.7688,-0.7118,-0.6628,-0.6394,-0.6733,-0.6297,-0.5640,-0.5221,-0.5097,-0.4478,-0.3255,-0.1591,-0.0885,-0.0642,-0.1568,-0.1771,-0.1164,-0.1872,-0.0850,-0.0730,0.0002,0.0037,0.0094,0.0069,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*29
$PNORF,B1,050120,030101,3,0.02,0.01,48,0.1395,0.1216,0.1286,0.3676,0.4377,0.4091,0.3896,0.3992,0.4195,0.4237,0.4005,0.3939,0.3832,0.3765,0.3746,0.3672,0.2828,0.3004,0.2950,0.2330,0.2287,0.2303,0.2178,0.0928,0.1469,0.0727,0.1510,0.2309,0.2103,0.0604,0.0236,0.0016,0.0688,0.0461,0.0068,0.0185,0.0154,0.0320,0.0180,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*0A
$PNORF,A2,050120,030101,3,0.02,0.01,48,0.1193,0.1092,0.1544,0.3439,0.5711,0.6388,0.6663,0.6322,0.5780,0.5374,0.5553,0.4927,0.4531,0.4006,0.3816,0.3660,0.3205,0.2420,0.2247,0.2508,0.2521,0.1595,0.1315,0.0646,0.1054,0.0172,-0.0698,-0.0778,-0.1924,-0.0335,-0.0354,0.0020,-0.0269,-0.0078,-0.0463,-0.0014,-0.0384,-0.0575,-0.0600,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*0C
$PNORF,B2,050120,030101,3,0.02,0.01,48,-0.0954,-0.1297,-0.1185,-0.4381,-0.7287,-0.7271,-0.6963,-0.6911,-0.7031,-0.6954,-0.6560,-0.6046,-0.5553,-0.5122,-0.4916,-0.4711,-0.2769,-0.2434,-0.2079,-0.1738,-0.1412,-0.1737,-0.1477,-0.0473,-0.0295,-0.0004,0.0569,0.0685,0.0846,0.0598,-0.0667,-0.0708,-0.0491,-0.0070,-0.0307,-0.0201,-0.0041,0.0321,0.0409,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000,-9.0000*20
$PNORI,3,WAV7575,3,18,0.41,1.00,0*1B
$PNORS,050120,032000,00,30,14.6,1512.8,290.9,2.0,0.2,15.552,17.01,0,0*69
$PNORC,050120,032000,1,0.03,-0.01,-0.05,0.04,110.0,C,148,144,147,,,*0A
$PNORC,050120,032000,2,0.03,0.02,-0.01,0.04,58.5,C,136,132,135,,,*16
$PNORC,050120,032000,3,0.03,0.03,-0.02,0.05,45.0,C,127,123,129,,,*10
$PNORC,050120,032000,4,0.06,0.02,-0.02,0.06,74.1,C,117,114,120,,,*1D
$PNORC,050120,032000,5,0.07,0.03,-0.01,0.07,65.5,C,108,105,110,,,*17
$PNORC,050120,032000,6,0.07,-0.02,-0.02,0.07,107.4,C,103,99,101,,,*30
$PNORC,050120,032000,7,0.11,-0.00,-0.01,0.11,92.7,C,98,92,95,,,*0A
$PNORC,050120,032000,8,0.11,0.00,-0.02,0.11,90.0,C,91,87,91,,,*27
$PNORC,050120,032000,9,0.12,-0.08,-0.02,0.14,124.8,C,83,81,85,,,*33
$PNORC,050120,032000,10,0.15,-0.04,-0.03,0.15,106.4,C,77,75,77,,,*01
$PNORC,050120,032000,11
,0.11,-0.07,-0.03,0.13,121.8,C,72,70,73,,,*0C

"""

FILES_DIR = Path(__file__).parent.parent / "sample_files"


def give_expected_Hs():
    D = AWAC_EXAMPLE_DATA.replace("\n", "")
    D = D.replace("$", "\n$")

    Hs = []

    for d in parse_awac_nmnea_wave_parameters(D.split("\n")):
        Hs.append(d["Hm0"])

    return Hs


def give_expected_Tp():
    D = AWAC_EXAMPLE_DATA.replace("\n", "")
    D = D.replace("$", "\n$")

    Tp = []

    for d in parse_awac_nmnea_wave_parameters(D.split("\n")):
        Tp.append(d["Tp"])

    return Tp


def test_awac_Hs():
    D = AWAC_EXAMPLE_DATA.replace("\n", "")
    D = D.replace("$", "\n$")

    data = read_awac_strings(D.split("\n"))

    Hs_expected = give_expected_Hs()
    Hs_actual = data.spec.hs().values

    assert_allclose(Hs_actual, Hs_expected, rtol=1e-1)


def test_awac_Tp():
    D = AWAC_EXAMPLE_DATA.replace("\n", "")
    D = D.replace("$", "\n$")

    data = read_awac_strings(D.split("\n"))

    Tp_expected = give_expected_Tp()
    Tp_actual = data.spec.tp().values

    assert_allclose(Tp_actual, Tp_expected, rtol=1e-1)


def test_awac_Hs_file():
    data = read_awac(FILES_DIR / "nortec_awac.nmea")

    Hs_expected = give_expected_Hs()
    Hs_actual = data.spec.hs().values

    assert_allclose(Hs_actual, Hs_expected, rtol=1e-1)


def test_awac_Tp_file():
    data = read_awac(FILES_DIR / "nortec_awac.nmea")

    Tp_expected = give_expected_Tp()
    Tp_actual = data.spec.tp().values

    assert_allclose(Tp_actual, Tp_expected, rtol=1e-1)


if __name__ == "__main__":
    # clean data
    D = AWAC_EXAMPLE_DATA.replace("\n", "")
    D = D.replace("$", "\n$")

    spectra = read_awac_strings(D.split("\n"))

    for t in spectra.time:
        plt.figure()
        spectra.sel(time=t).spec.plot(cmap="viridis_r")

    plt.show()
